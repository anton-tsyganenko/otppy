otppy
=====
реализация шифра "одноразовый блокнот", написанная на python

##опции

`-o file`, `--output-file=file` - направить вывод в файл (в случае генерации ключей - в папку)  
`-i file`, `--input-file=file` - получить данные из файла  
`-k folder`, `--keys-folder=folder` - взять ключ из папки  
`-I mode`, `--input-mode=mode` - режим ввода данных (может быть hex или bin)  
`-O mode`, `--output-mode=mode` - режим вывода данных (может быть hex или bin)  
`-c action`, `--hash=action` - использовать контрольную сумму (`add` - для добавления (при расшифровании)  или `check` - для проверки (при расшифровании))  
`--gen-keys` - генерировать ключи  
`--no-spaces` - не вставлять пробелы в шестнадцатеричный код  
`--key-action action` - действия с использованным ключем (варианты: `leave` - оставить, `delete` - удалить, `rename` - переименовать, чтобы пометить как использованный)  

##быстрый старт

1. Создайте папки с ключами командами `./otp.py --gen-keys -o you_to_interlocutor` и `./otp.py --gen-keys -o interlocutor_to_you`. Программа будет спрашивать вас количество ключей, которое равно количеству сообщений, которое вы сможете передать и длину ключей, равную максимальной длине сообщения. Не стоит делать эти цифры слишком низкими, чтобы не возникло нехватки ключей или неприятностей от ограничений по длине сообщения. Рекомендуется создать 100-10000 ключей размером 100-10000 байт, в зависимости от потребностей. Если создавать слишком много ключей или делать их слишком длинными, могут возникнуть такие проблемы, как долгая генерация/шифрование или большой объем занимаемых данных. Если связь односторонняя, можете сделать только одну папку с ключами или сделать маленькую 2 папку на случай необходимости передачи сообщения.
2. Передайте эту папку своему собеседнику по **защищенному** каналу. Перед этим можете упаковать ее в архив без сжатия.
3. Чтобы передать собеседнику сообщение, используйте команду `./otp.py -k you_to_interlocutor -c add`. Введите свое сообщение, после этого нажмите enter а затем ctrl+d. Передайте собеседнику полученный шестнадцатеричный код.
4. Чтобы расшифровать полученное сообщение, используйте команду `./otp.py -k interlocutor_to_you -c check`. Введите код, после этого нажмите enter.
5. Следите за количеством оставшихся ключей. Оно равно количеству файлов (исключая файлы, кончающиеся на "_used") в папке с ключами. Когда ключи закончатся, повторите 1 и 2 пункты.

##примеры

геренация папки с ключами:

    ./otp.py --gen-keys -o keys

преобразование (шифрование/расшифровывание) с ручным вводом текста и ключа:

    ./otp.py

преобразование с ручным вводом текста и использованием ключа из папки:

    ./otp.py -k keys

преобразование с ручным вводом текста, использованием ключа из папки и добавлением контрольной суммы:

    ./otp.py -k keys -с add

преобразование файла с использованием ключа из папки:

    ./otp.py -k keys -i file.in -o file.out

для получение текста из шестнадцатеричного кода используйте команду `./otp.py -I hex -O bin`, в качестве ключа используйте нули:

    enter the text > 68 65 6c 6c 6f 2c 20 70 79 74 68 6f 6e
    enter the key > 00 00 00 00 00 00 00 00 00 00 00 00 00
    ================

    hello, python

##также

* Настоятельно рекомендуется создать 2 комплекта ключей: для сообщений, которые вы посылаете своему собеседнику и сообщений, которые он посылает вам. Если вы и ваш собеседник одновременно зашифруете и отправите сообщения, ключ будет использован дважды, что крайне небезопасно.
* Если злоумышленник узнает часть ключа/сообщения, он может подменить эту часть сообщения. Чтобы проверить подлинность сообщения, используйте контрольную сумму. Помните, что она не защищает от подделки в случаях, когда злоумылшеннику известен весь ключ.
* При шифровании файлов следите, чтобы свободной оперативной памяти было больше, чем размер файла, умноженный на 3.
* Программа может использоваться в случае, если есть 2 канала, каждый из которых в отдельности может прослушиваться. Тогда надо передавать ключи по одному каналу, а сообщения - по другому. Чтобы расшифровать сообщения, потребуется прослушать оба канала.
* Надежность шифра зависит от безопасности способа передачи ключей. Рекомендуется передавать ключи при личной встрече на флешке или диске. Для большей надежности можно шифровать ключи с помощью truecrypt, зашифрованных zip-архивов и т.д.
* Учтите, что кириллические символы могут занимать больше 1 байта.
* Про шифр Вернама можно [почитать на википедии](http://ru.wikipedia.org/wiki/Шифр_Вернама)
* Если вы заметили ошибку в программе, у вас возникли вопросы или вы хотите предложить какие-то улучшения, не стесняйтесь связаться со мной по [электронной почте](mailto:anton-tsyganenko@yandex.ru) или [jabber](xmpp:antontsyganenko@jabber.ru).
